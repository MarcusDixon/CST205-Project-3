<!DOCTYPE html>
<html lang="en">
<head>
<meta charset=utf-8>
</head>

<body>
<<<<<<< HEAD
<link rel = "stylesheet" type = "text/css" href = "CSS/Style.css">
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
=======
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
>>>>>>> 3a1bf529be769f7fdfde21dcad16f5fd52bc4cb2
<script type="text/javascript" src='../remix.js'></script>

<script type="text/javascript">

// Hop through the beats of a track using the arrow keys
// You will need to supply your Echo Nest API key, the trackID, and a URL to the track.
// The supplied track can be found in the audio subdirectory.

//############################################
//TAKE OFF API KEY BEFORE COMMITTING
var apiKey = '';
//############################################
var trackID = 'TRCYWPQ139279B3308';
var trackURL = 'audio/1451_-_D.mp3';
var trackID2 = 'TRBIBEW13936EB37C9';
var trackURL2 = 'audio/1451_-_E.mp3'

<<<<<<< HEAD
var i=0;
=======
var sound;
>>>>>>> 3a1bf529be769f7fdfde21dcad16f5fd52bc4cb2
var context;
var remixer;
var player;
var player2;
var track;
var remixed;
var remixed2;
var newTrack;
var playbackIndex = -1;
var myjson;
var remixCon;
<<<<<<< HEAD

function getSongID(){
=======
var remixCon2;
function getSong(){
>>>>>>> 3a1bf529be769f7fdfde21dcad16f5fd52bc4cb2

    $.ajax({
  url: 'http://developer.echonest.com/api/v4/song/search?api_key='+apiKey+'&artist=kanye%20west&title=all%20of%20the%20lights',
  dataType: 'json',
  async: false,
  success: function(data) {

    myjson = data;

  }
});
<<<<<<< HEAD
console.log(myjson["response"]["songs"][0]["id"]); 
  
=======
console.log(myjson);

>>>>>>> 3a1bf529be769f7fdfde21dcad16f5fd52bc4cb2
}


function getRemix(remixer,player,trackID,trackURL,track,context,apiKey,info)
{
   remixer = createJRemixer(context, $, apiKey);

        player = remixer.getPlayer();

        $(info).text("Loading analysis data...");

        remixer.remixTrackById(trackID, trackURL, function(t, percent) {
            track = t;

            $(info).text(percent + "% of the track loaded");
            if (percent == 100) {
                $(info).text(percent + "% of the track loaded, remixing...");
            }

            if (track.status == 'ok') {

                remixed = new Array();
                for (var i=0; i < track.analysis.beats.length; i++) {
                    remixed.push(track.analysis.beats[i])
                }
                $(info).text("Remix complete!");
                for(i=0;i<remixed.length-42;i++)
               {
                makeButtons(i,"button",remixed);
                }
            }
        });
    return [remixer,remixed,track,player];
}
function makeSoundButtons(name,path)
{
    
}
function makeButtons( index,name,remixed)
{
    //Create an input type dynamically.
    var element = document.createElement("input");
    //Assign different attributes to the element.
    element.type = "button";
    element.value = ""; 
    element.name = name;  
    element.id=name;
    element.style.backgroundColor=makeColor();
    element.onclick = function() { // Note this is a function
    if(index==0)
    {
        player2.play(0,remixed[index]);
    }
    else{
        player2.play(remixed[index],remixed[index+40]);
    }
    element.style.backgroundColor=makeColor();
    };

<<<<<<< HEAD
    var myButtons= document.getElementById("buttons");
    //Append the element in page (in span).  
    myButtons.appendChild(element);
=======


    var foo = document.getElementById("buttons");
    //Append the element in page (in span).
    foo.appendChild(element);
>>>>>>> 3a1bf529be769f7fdfde21dcad16f5fd52bc4cb2
}

function init() {
    var contextFunction = window.webkitAudioContext || window.AudioContext;
    if (contextFunction === undefined) {
        $("#info").text("Sorry, this app needs advanced web audio. Your browser doesn't"
            + " support it. Try the latest version of Chrome?");
    } else {
       context = new contextFunction();
       context2= new contextFunction();
       getSongID();
        remixCon= getRemix(remixer,player,trackID,trackURL,track,context,apiKey,"#info");
        remixer = remixCon[0];
        remixed = remixCon[1];
        track  = remixCon[2];
        player = remixCon[3];
       player2 = remixer.getPlayer();
        var next=0;
        var j=0;
    // Set up the keyboard controls
    document.addEventListener('keydown', function(event) {
        if(event.which==78)//on n
        {
       
        }
        if(event.which ==82)
        {
            if(i=remixed.length)
            {
                j=0;
            }
<<<<<<< HEAD
            player.play(0,remixed[j]);
            j++
=======


                player.play(0,remixed[i]);
            i++
>>>>>>> 3a1bf529be769f7fdfde21dcad16f5fd52bc4cb2
        }
        if (event.which == 39) {  // right arrow
            playbackIndex = playbackIndex + 1;
            if (playbackIndex > remixed.length - 1) {
                playbackIndex = 0;
            }
            player.play(0, remixed[playbackIndex]);

        }

        if (event.which == 37) {  // left arrow
            playbackIndex = playbackIndex - 1;
            if (playbackIndex < 0) {
                playbackIndex = remixed.length - 1;
            }
            player.play(0, remixed[playbackIndex]);
        }

        if (event.which == 40) {  // down arrow
            playbackIndex = playbackIndex - 4;
            if (playbackIndex < 0) {
                playbackIndex = remixed.length - 1;
            }
            player.play(0, remixed[playbackIndex]);
        }

        if (event.which == 38) {  // up arrow
            playbackIndex = playbackIndex + 4;
            if (playbackIndex > remixed.length - 1) {
                playbackIndex = 0;
            }
<<<<<<< HEAD
      
            player.play(0, remixed[playbackIndex]);
=======


>>>>>>> 3a1bf529be769f7fdfde21dcad16f5fd52bc4cb2
        }
        if (event.which== 73){//on i

          player.fadeOut();
        }
        if (event.which==65)//on a    fade in
        {
            player.fadeIn();
            //console.log( player.endTime()); does not work neeeds to be deleted
        }
        if(event.which==81)//on q
        {
<<<<<<< HEAD
          
       
        
=======


        for(i=0;i<remixed.length-42;i++)
        {
        makeButtons(i,"button"+i,remixed);
        }
>>>>>>> 3a1bf529be769f7fdfde21dcad16f5fd52bc4cb2
        }
        if (event.which== 80)//on p
        {
        console.log(remixed2);
          player.play(0,remixed);

        }
        if(event.which== 9){//tab key replay
        player.stop();
        player.play(0,remixed);
        }
        if(event.which== 83){// s key
         getSong(trackURL2);
        }

    });
    }
}

function getSong(){
  var audio = value ;
  audio.play();
}


function makeColor(){

  var hexColor = ['a', 'b', 'c', 'd', 'e', 'f', '0','1', '2', '3', '4', '5', '6', '7', '8', '9'];

  var x = '#';
  for(var i = 1; i <=6; i++){

    var y = Math.floor((Math.random() * 16));
    x += hexColor[y];
    //document.getElementById("demo").innerHTML = x;
  }
  return x;

}

<<<<<<< HEAD

=======
>>>>>>> 3a1bf529be769f7fdfde21dcad16f5fd52bc4cb2
window.onload = init;
</script>

Welcome to Driver.html
<div id='info'> </div><br>
<div id='info2'></div>
Press the right and left arrow keys to move through the track by beat.
Press the up and and down arrow keys to move through the track by bar.
Press the tab keys to replay the song
Press the  s to stop the song
<button onClick="player.stop()">Stop!</button>
<span id="buttons" ></span>

</body>



</html>
